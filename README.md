# Work Performance Aggregator (稼働実績集計ツール)

Excel VBAを活用し、チームメンバー個別の各日報データから稼働実績を自動抽出し、集計・管理を効率化するツールです。

## 概要

保存されている個人の日報ファイル（.xlsx）から情報を読み取り、管理用の集計マスターファイル（.xlsm）へ統合します。手作業による転記ミスを防止し、チーム全体の稼働状況を迅速に可視化することを目的としています。約5人分の集計に30分かかっていたのが、本ツールの導入により1分で完了するようになりました。

## 機能

1. 日報データ集計
   - 個人の日報ファイルから「体調数値」「業務内容」「作業時間」を自動抽出
   - 業務項目ごとに作業時間を集計し、個人別およびチーム全体の合計シートへ転記
   - 日単位または週単位での一括転記に対応

2. チームメンバー管理（担当追加）
   - 新規メンバー追加時、社員番号と氏名に基づいた個人フォルダおよび日報ファイルを自動生成
   - 既存の全メンバーの日報設定を同期更新

3. マスタデータ同期（業務追加）
   - 集計ツール側で追加した新しい業務項目を、全メンバーの日報ファイルへ一括反映

4. 入力用シート自動生成
   - 全メンバーの日報ファイルに対し、翌週分の入力用シートを日付セット済みの状態で一括作成

## アピールポイント

1.  堅牢な入力値検証 (Robust Input Validation)
    ユーザーが誤ったデータを入力した際にツールが停止しないよう、多段階のチェックロジックを実装しています。- **日付妥当性チェック**: IsDate 関数による形式チェックに加え、「2024年以降であるか」「4月以降であるか」「指定日が月曜日であるか」といった業務ルールに基づく論理チェックを行っています - **キャンセル・空文字対応**: InputBoxでの入力キャンセルや空送信を検知し、安全に処理を中断するガード節を設けています

2.  エラーハンドリングと安全性 (Error Handling & Safety)
    外部ファイル操作時の予期せぬエラーを回避し、データの整合性を保つ工夫をしています。- **シート存在チェック**: 転記先のシートが存在しない場合、即座にエラーで終了するのではなく、ユーザーに通知した上でアプリケーション設定（警告表示など）を正常に戻してから安全に終了するフローを構築しています - **アプリケーション状態の管理**: バックグラウンド処理中にエラーが起きても、必ず DisplayAlerts = True に戻して終了するように実装し、Excel自体の操作不能状態を防いでいます

3.  コードのモジュール化
    機能ごとにモジュールを分割し、保守性を高めています。

        - 役割分担:

            - ***main***: ユーザーインターフェースとメインフロー制御
            - ***fileFunc***: ファイル・フォルダ操作系
            - ***nippouFunc***: 日報データの読み書き・集計ロジック
            - ***memberFunc / gyoumuFunc***: マスタデータ管理

## ディレクトリ構成

```Plaintext
.
├── 2024年度稼働実績集計ツール.xlsm  # 集計メインツール
├── 2024年度日報(原本).xlsx        # 新規作成用の原本
└── [社員番号＋氏名]/               # 各担当者の個別フォルダ
    └── 2024年度日報(氏名).xlsx    # 個人の入力用日報
```

## 使用方法

1. 2024年度稼働実績集計ツール.xlsm を開きます
2. 「プログラム実行」シートから、目的の操作（日報転記、担当追加など）のボタンをクリックします
3. 画面の指示に従い、集計したい週の月曜日の日付などを入力して実行します
